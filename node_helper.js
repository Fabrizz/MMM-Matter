/*
  ┌────────────────────────────────────────────────────────────────┐
  │                    MMM-Matter by Fabrizz <3                    │
  │              https://github.com/Fabrizz/MMM-Matter             │
  │                        (c) Fabrizio Bap                        │
  │                                                                │
  ├─ Version 1.0.0 MIT License                                     │
  └────────────────────────────────────────────────────────────────┘
*/

// [⚠] This file is auto-generated. DO NOT EDIT.

var _=Object.create;var x=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var G=(r,e,o,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of B(e))!q.call(r,s)&&s!==o&&x(r,s,{get:()=>e[s],enumerable:!(t=D(e,s))||t.enumerable});return r};var l=(r,e,o)=>(o=r!=null?_(P(r)):{},G(e||!r||!r.__esModule?x(o,"default",{value:r,enumerable:!0}):o,r));var k=l(require("node_helper")),d=l(require("logger")),v=l(require("express")),b=l(require("path")),A=require("events");var i={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",underscore:"\x1B[4m",blink:"\x1B[5m",reverse:"\x1B[7m",hidden:"\x1B[8m",FG:{black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m",gray:"\x1B[90m",crimson:"\x1B[38m"},BG:{black:"\x1B[40m",red:"\x1B[41m",green:"\x1B[42m",yellow:"\x1B[43m",blue:"\x1B[44m",magenta:"\x1B[45m",cyan:"\x1B[46m",white:"\x1B[47m",gray:"\x1B[100m",crimson:"\x1B[48m"}};var F=l(require("logger"));var n=require("@matter/main"),m=require("@matter/main/protocol"),y=require("@matter/main/endpoints/aggregator"),$=require("@matter/main/types"),R=require("@matter/main/behaviors/bridged-device-basic-information"),T=require("@matter/main/devices/on-off-plug-in-unit"),V=`${i.reset}[${i.FG.magenta}MMM-Matter${i.reset}] (${i.FG.green}MatterServer${i.reset})`,u=class{constructor(e,o,t,s,a,c){this.environment=n.Environment.default,this.environment.vars.set("storage.path",o),F.info(`${V} Store path updated. ${i.FG.gray}${o}${i.reset}`),c&&this.environment.vars.set("mdns.networkInterface",c),this.mdnsInterface=c,this.environment.vars.set("log.level",t),this.environment.vars.set("log.format",s),this.storageService=this.environment.get(n.StorageService),this.moduleStorageService=e,this.moduleVersionString=a}async startServerNode(){let e="MMM-Matter Bridge",o="MMM Bridge",t="fabrizz",a=(await this.storageService.open("device")).createContext("data"),c=await a.get("passcode",20202021),O=await a.get("discriminator",3840),M=await a.get("vendorid",65521),L=await a.get("productid",32768),f=await a.get("uniqueid",n.Time.nowMs().toString());if(await a.set({passcode:c,discriminator:O,vendorid:M,productid:L,uniqueid:f}),this.serverNode=await n.ServerNode.create({id:f,network:{port:5540},commissioning:{passcode:c,discriminator:O},productDescription:{name:o,deviceType:y.AggregatorEndpoint.deviceType},basicInformation:{vendorName:t,vendorId:(0,$.VendorId)(M),nodeLabel:e,productName:e,productLabel:e,productId:L,serialNumber:`MMM-MATTER-${f}`,uniqueId:f,hardwareVersionString:this.moduleVersionString,softwareVersionString:this.moduleVersionString,hardwareVersion:1,softwareVersion:1,productUrl:"https://github.com/Fabrizz/MMM-Matter",reachable:!0}}),this.serverAggregator=new n.Endpoint(y.AggregatorEndpoint,{id:"aggregator"}),await this.serverNode.add(this.serverAggregator),await this.addSavedEndpointsToServer(),this.serverNode.lifecycle.commissioned.on(()=>console.log("Server was initially commissioned successfully!")),this.serverNode.lifecycle.decommissioned.on(()=>console.log("Server was fully decommissioned successfully!")),this.serverNode.lifecycle.online.on(()=>{console.log("Server is online"),console.log("Initial Fabrics when coming online",this.serverNode.state.commissioning.fabrics)}),this.serverNode.lifecycle.offline.on(()=>console.log("Server is offline")),this.serverNode.events.commissioning.fabricsChanged.on((p,N)=>{let h="";switch(N){case m.FabricAction.Added:h="added";break;case m.FabricAction.Removed:h="removed";break;case m.FabricAction.Updated:h="updated";break}console.log(`Commissioned Fabrics changed event (${h}) for ${p} triggered`,this.serverNode.state.commissioning.fabrics[p])}),await this.serverNode.start(),(0,m.logEndpoint)(n.EndpointServer.forEndpoint(this.serverNode)),this.serverNode.lifecycle.isCommissioned)console.log("Device is already commissioned. Waiting for controllers to connect ...");else{let{qrPairingCode:p,manualPairingCode:N}=this.serverNode.state.commissioning.pairingCodes;console.log(`QR Code URL: https://project-chip.github.io/connectedhomeip/qrcode.html?data=${p}`),console.log(`Manual pairing code: ${N}`)}}async addSavedEndpointsToServer(){let e="OnOff light",o=new n.Endpoint(T.OnOffPlugInUnitDevice.with(R.BridgedDeviceBasicInformationServer),{id:"onoff-1",bridgedDeviceBasicInformation:{nodeLabel:e,productName:e,productLabel:e,serialNumber:"node-matter-1",reachable:!0}});await this.serverAggregator.add(o),o.events.identify.startIdentifying.on(()=>{console.log(`Run identify logic for ${e}, ideally blink a light every 0.5s ...`)}),o.events.identify.stopIdentifying.on(()=>{console.log(`Stop identify logic for ${e} ...`)}),o.events.onOff.onOff$Changed.on(t=>{console.log(`${e} is now ${t?"ON":"OFF"}`)})}};var g=require("node-persist"),E=b.join(__dirname,"/module-store"),C=b.join(__dirname,"/matter-store"),w=b.join(__dirname,"client","dist"),I="1.0.0",S=`${i.reset}[${i.FG.magenta}MMM-Matter${i.reset}] (NodeHelper)`;g.init({dir:E}).then(async()=>{d.info(`${S} Module store initiated. ${i.FG.gray}Path: ${E}${i.reset}`),await g.getItem("isFirstSession")===void 0&&await g.setItem("isFirstSession",!0)});module.exports=k.create({start(){d.log(`${S} ${i.FG.black}${i.BG.white} ⠖ MMM-Matter by Fabrizz ${i.reset} Node helper loaded.`),this.VERSION=I||"",this.frontendReady=!1,this.apiEventsConsumers=new Map,this.events=new A.EventEmitter,this.translations={},this.matterServer=null;let r=v.Router(),e=v.Router();e.route("/version").get((o,t)=>{t.send(this.VERSION)}),e.route("/paths").get((o,t)=>{t.send({PATH_MODULE_STORE:E,PATH_MATTER_STORE:C,PATH_CLIENT_DIST:w})}),e.route("/translations").get((o,t)=>{t.send(this.translations)}),e.route("/store").get(async(o,t)=>{t.send(await g.keys())}),e.route("/store/:key").get(async(o,t)=>{t.send(await g.getItem(o.params.key))}),e.route("/state/:deviceId").get((o,t)=>{t.send({data:"test",ts:Date.now()})}),e.get("/events",async(o,t)=>{t.set({"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive","Access-Control-Allow-Origin":"*"}),t.flushHeaders(),t.write(`retry: 10000

`);let s=Date.now().toString(16);this.apiEventsConsumers.set(s,t),t.on("close",()=>this.apiEventsConsumers.delete(s))}),r.use("/",v.static(w)),r.use("/api",e),this.expressApp.use("/matter",r),d.info(`${S} Started frontend. ${i.FG.gray}Build path: ${w}${i.reset}`)},socketNotificationReceived:async function(r,e){switch(r){case"FRONTEND_READY":this.frontendReady?d.info(`${S} Frontend has been reloaded.`):(this.frontendReady=!0,this.matterServer=new u(g,C,e.matterLogLevel,e.matterLogFormat,I),this.matterServer.startServerNode());break;case"FRONTEND_TRANSLATIONS":this.translations=e,this.sendToClientEventStream("RELOAD_FRONTEND");break;case"NOTIFICATION_FORBACKEND":d.debug("NOTIFICATION_FORBACKEND",`__${e.tag} 
`,JSON.stringify(e)),this.events.emit(`__${e.tag}`,e);break}},sendToMM2EventStream(r,e={}){this.sendToClientEventStream("CONTROL_MODULES",{tag:r,payload:e}),this.sendSocketNotification("CONTROL_MODULES",{tag:r,payload:e})},sendToClientEventStream(r,e={}){this.apiEventsConsumers.forEach(o=>o.write(`data: ${JSON.stringify({tag:r,payload:e})}

`))}});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL2JhY2tlbmQvYmFja2VuZC50cyIsICJzcmMvYmFja2VuZC91dGlscy50cyIsICJzcmMvYmFja2VuZC9tYXR0ZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90eXBlcy9tYWdpY21pcnJvci1tb2R1bGUuZC50c1wiIC8+XHJcblxyXG5pbXBvcnQgKiBhcyBOb2RlSGVscGVyIGZyb20gJ25vZGVfaGVscGVyJ1xyXG5pbXBvcnQgKiBhcyBMb2cgZnJvbSAnbG9nZ2VyJ1xyXG5pbXBvcnQgKiBhcyBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xyXG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIgfSBmcm9tICdldmVudHMnO1xyXG5pbXBvcnQgeyBDT0xPUlMgfSBmcm9tIFwiLi91dGlsc1wiXHJcbmltcG9ydCB7IEZyb250ZW5kUmVhZHlQYXlsb2FkLCBOb3RpZmljYXRpb25Gb3JCYWNrZW5kUGF5bG9hZCB9IGZyb20gJy4uL3R5cGVzL21vZHVsZSc7XHJcbmltcG9ydCB7IE1hdHRlclNlcnZlciB9IGZyb20gJy4vbWF0dGVyJztcclxuXHJcbmltcG9ydCB0eXBlIE5vZGVQZXJzaXN0IGZyb20gJ25vZGUtcGVyc2lzdCc7XHJcbi8qKiBNb2R1bGUgc3RvcmFnZSwgc2F2ZXMgdXNlci1mYWNpbmcgbm90aWZpY2F0aW9uIGRlZmluaXRpb25zICovXHJcbmNvbnN0IHN0b3JhZ2U6IE5vZGVQZXJzaXN0LkxvY2FsU3RvcmFnZSA9IHJlcXVpcmUoJ25vZGUtcGVyc2lzdCcpO1xyXG5cclxuY29uc3QgUEFUSF9NT0RVTEVfU1RPUkUgPSBwYXRoLmpvaW4oX19kaXJuYW1lLCBcIi9tb2R1bGUtc3RvcmVcIik7XHJcbmNvbnN0IFBBVEhfTUFUVEVSX1NUT1JFID0gcGF0aC5qb2luKF9fZGlybmFtZSwgXCIvbWF0dGVyLXN0b3JlXCIpO1xyXG5jb25zdCBQQVRIX0NMSUVOVF9ESVNUID0gcGF0aC5qb2luKF9fZGlybmFtZSwgXCJjbGllbnRcIiwgXCJkaXN0XCIpO1xyXG5cclxuLy8gQHRzLWV4cGVjdC1lcnJvciBcIjEuMC4wXCIgaXMgcmVwbGFjZWQgYnkgUm9sbHVwXHJcbmNvbnN0IE1PRFVMRV9WRVJTSU9OOiBzdHJpbmcgPSBcIjEuMC4wXCI7XHJcbmNvbnN0IE1PRFVMRV9UQUcgPSBgJHtDT0xPUlMucmVzZXR9WyR7Q09MT1JTLkZHLm1hZ2VudGF9TU1NLU1hdHRlciR7Q09MT1JTLnJlc2V0fV0gKE5vZGVIZWxwZXIpYDtcclxuXHJcbnN0b3JhZ2UuaW5pdCh7IGRpcjogUEFUSF9NT0RVTEVfU1RPUkUgfSkudGhlbihhc3luYyAoKSA9PiB7XHJcbiAgTG9nLmluZm8oYCR7TU9EVUxFX1RBR30gTW9kdWxlIHN0b3JlIGluaXRpYXRlZC4gJHtDT0xPUlMuRkcuZ3JheX1QYXRoOiAke1BBVEhfTU9EVUxFX1NUT1JFfSR7Q09MT1JTLnJlc2V0fWApO1xyXG5cclxuICBjb25zdCBpc0ZpcnN0U2Vzc2lvbiA9IGF3YWl0IHN0b3JhZ2UuZ2V0SXRlbShcImlzRmlyc3RTZXNzaW9uXCIpO1xyXG4gIGlmIChpc0ZpcnN0U2Vzc2lvbiA9PT0gdW5kZWZpbmVkKSB7IGF3YWl0IHN0b3JhZ2Uuc2V0SXRlbShcImlzRmlyc3RTZXNzaW9uXCIsIHRydWUpIH1cclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IE5vZGVIZWxwZXIuY3JlYXRlKHtcclxuICBzdGFydCgpIHtcclxuICAgIExvZy5sb2coYCR7TU9EVUxFX1RBR30gJHtDT0xPUlMuRkcuYmxhY2t9JHtDT0xPUlMuQkcud2hpdGV9IOKgliBNTU0tTWF0dGVyIGJ5IEZhYnJpenogJHtDT0xPUlMucmVzZXR9IE5vZGUgaGVscGVyIGxvYWRlZC5gKTtcclxuXHJcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIERlY2xhcmF0aW9uc1xyXG4gICAgdGhpcy5WRVJTSU9OID0gTU9EVUxFX1ZFUlNJT04gfHwgXCJcIjtcclxuICAgIHRoaXMuZnJvbnRlbmRSZWFkeSA9IGZhbHNlO1xyXG4gICAgdGhpcy5hcGlFdmVudHNDb25zdW1lcnMgPSBuZXcgTWFwKCk7XHJcbiAgICB0aGlzLmV2ZW50cyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIHRoaXMudHJhbnNsYXRpb25zID0ge307XHJcbiAgICB0aGlzLm1hdHRlclNlcnZlciA9IG51bGw7XHJcblxyXG4gICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEFwaSByb3V0ZXNcclxuICAgIGNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbiAgICBjb25zdCBhcGlSb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5cclxuICAgIGFwaVJvdXRlci5yb3V0ZShcIi92ZXJzaW9uXCIpLmdldCgocSwgcikgPT4geyByLnNlbmQodGhpcy5WRVJTSU9OKSB9KTtcclxuICAgIGFwaVJvdXRlci5yb3V0ZShcIi9wYXRoc1wiKS5nZXQoKHEsIHIpID0+IHsgci5zZW5kKHsgUEFUSF9NT0RVTEVfU1RPUkUsIFBBVEhfTUFUVEVSX1NUT1JFLCBQQVRIX0NMSUVOVF9ESVNUIH0pIH0pO1xyXG4gICAgYXBpUm91dGVyLnJvdXRlKFwiL3RyYW5zbGF0aW9uc1wiKS5nZXQoKHEsIHIpID0+IHsgci5zZW5kKHRoaXMudHJhbnNsYXRpb25zKSB9KTtcclxuICAgIGFwaVJvdXRlci5yb3V0ZShcIi9zdG9yZVwiKS5nZXQoYXN5bmMgKHEsIHIpID0+IHsgci5zZW5kKGF3YWl0IHN0b3JhZ2Uua2V5cygpKSB9KTtcclxuICAgIGFwaVJvdXRlci5yb3V0ZShcIi9zdG9yZS86a2V5XCIpLmdldChhc3luYyAocSwgcikgPT4geyByLnNlbmQoYXdhaXQgc3RvcmFnZS5nZXRJdGVtKHEucGFyYW1zLmtleSkpIH0pO1xyXG5cclxuICAgIGFwaVJvdXRlci5yb3V0ZShcIi9zdGF0ZS86ZGV2aWNlSWRcIikuZ2V0KChxLCByKSA9PiB7XHJcbiAgICAgICAgci5zZW5kKHsgZGF0YTogXCJ0ZXN0XCIsIHRzOiBEYXRlLm5vdygpIH0pO1xyXG4gICAgICB9KVxyXG5cclxuICAgIGFwaVJvdXRlci5nZXQoXCIvZXZlbnRzXCIsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICByZXMuc2V0KHtcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcInRleHQvZXZlbnQtc3RyZWFtXCIsXHJcbiAgICAgICAgXCJDYWNoZS1Db250cm9sXCI6IFwibm8tY2FjaGVcIixcclxuICAgICAgICBcIkNvbm5lY3Rpb25cIjogXCJrZWVwLWFsaXZlXCIsXHJcbiAgICAgICAgXCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW5cIjogXCIqXCIsXHJcbiAgICAgIH0pO1xyXG4gICAgICByZXMuZmx1c2hIZWFkZXJzKCk7XHJcbiAgICAgIHJlcy53cml0ZShcInJldHJ5OiAxMDAwMFxcblxcblwiKTtcclxuXHJcbiAgICAgIGNvbnN0IGNsaWVudElkID0gRGF0ZS5ub3coKS50b1N0cmluZygxNik7XHJcbiAgICAgIHRoaXMuYXBpRXZlbnRzQ29uc3VtZXJzLnNldChjbGllbnRJZCwgcmVzKTtcclxuICAgICAgcmVzLm9uKFwiY2xvc2VcIiwgKCkgPT4gdGhpcy5hcGlFdmVudHNDb25zdW1lcnMuZGVsZXRlKGNsaWVudElkKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByb3V0ZXIudXNlKFwiL1wiLCBleHByZXNzLnN0YXRpYyhQQVRIX0NMSUVOVF9ESVNUKSk7XHJcbiAgICByb3V0ZXIudXNlKFwiL2FwaVwiLCBhcGlSb3V0ZXIpO1xyXG4gICAgdGhpcy5leHByZXNzQXBwLnVzZShcIi9tYXR0ZXJcIiwgcm91dGVyKTtcclxuICAgIExvZy5pbmZvKGAke01PRFVMRV9UQUd9IFN0YXJ0ZWQgZnJvbnRlbmQuICR7Q09MT1JTLkZHLmdyYXl9QnVpbGQgcGF0aDogJHtQQVRIX0NMSUVOVF9ESVNUfSR7Q09MT1JTLnJlc2V0fWApO1xyXG4gIH0sXHJcblxyXG4gIHNvY2tldE5vdGlmaWNhdGlvblJlY2VpdmVkOiBhc3luYyBmdW5jdGlvbiAobm90aWZpY2F0aW9uOiBTb2NrZXROb3RpZmljYXRpb25zRnJvbnRlbmQsIHBheWxvYWQ6IHVua25vd24pIHtcclxuICAgIHN3aXRjaCAobm90aWZpY2F0aW9uKSB7XHJcbiAgICAgIGNhc2UgXCJGUk9OVEVORF9SRUFEWVwiOlxyXG4gICAgICAgIGlmICh0aGlzLmZyb250ZW5kUmVhZHkpIHtcclxuICAgICAgICAgIExvZy5pbmZvKGAke01PRFVMRV9UQUd9IEZyb250ZW5kIGhhcyBiZWVuIHJlbG9hZGVkLmApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmZyb250ZW5kUmVhZHkgPSB0cnVlO1xyXG4gICAgICAgICAgdGhpcy5tYXR0ZXJTZXJ2ZXIgPSBuZXcgTWF0dGVyU2VydmVyKFxyXG4gICAgICAgICAgICBzdG9yYWdlLCBcclxuICAgICAgICAgICAgUEFUSF9NQVRURVJfU1RPUkUsXHJcbiAgICAgICAgICAgIChwYXlsb2FkIGFzIEZyb250ZW5kUmVhZHlQYXlsb2FkKS5tYXR0ZXJMb2dMZXZlbCxcclxuICAgICAgICAgICAgKHBheWxvYWQgYXMgRnJvbnRlbmRSZWFkeVBheWxvYWQpLm1hdHRlckxvZ0Zvcm1hdCxcclxuICAgICAgICAgICAgTU9EVUxFX1ZFUlNJT04sXHJcbiAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgIHRoaXMubWF0dGVyU2VydmVyLnN0YXJ0U2VydmVyTm9kZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIkZST05URU5EX1RSQU5TTEFUSU9OU1wiOlxyXG4gICAgICAgIHRoaXMudHJhbnNsYXRpb25zID0gcGF5bG9hZDtcclxuICAgICAgICB0aGlzLnNlbmRUb0NsaWVudEV2ZW50U3RyZWFtKFwiUkVMT0FEX0ZST05URU5EXCIpO1xyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGNhc2UgXCJOT1RJRklDQVRJT05fRk9SQkFDS0VORFwiOlxyXG4gICAgICAgIExvZy5kZWJ1ZyhcIk5PVElGSUNBVElPTl9GT1JCQUNLRU5EXCIsIGBfXyR7KHBheWxvYWQgYXMgTm90aWZpY2F0aW9uRm9yQmFja2VuZFBheWxvYWQpLnRhZ30gXFxuYCwgSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpOyAvLyA8LS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIHRoaXMuZXZlbnRzLmVtaXQoYF9fJHsocGF5bG9hZCBhcyBOb3RpZmljYXRpb25Gb3JCYWNrZW5kUGF5bG9hZCkudGFnfWAsIHBheWxvYWQgYXMgTm90aWZpY2F0aW9uRm9yQmFja2VuZFBheWxvYWQpO1xyXG4gICAgICAgIGJyZWFrXHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgc2VuZFRvTU0yRXZlbnRTdHJlYW0odGFnLCBwYXlsb2FkID0ge30pIHtcclxuICAgIHRoaXMuc2VuZFRvQ2xpZW50RXZlbnRTdHJlYW0oXCJDT05UUk9MX01PRFVMRVNcIiBhcyBTb2NrZXROb3RpZmljYXRpb25zQmFja2VuZCwgeyB0YWcsIHBheWxvYWQgfSk7XHJcbiAgICB0aGlzLnNlbmRTb2NrZXROb3RpZmljYXRpb24oXCJDT05UUk9MX01PRFVMRVNcIiwgeyB0YWcsIHBheWxvYWQgfSk7XHJcbiAgfSxcclxuXHJcbiAgc2VuZFRvQ2xpZW50RXZlbnRTdHJlYW0odGFnLCBwYXlsb2FkID0ge30pIHtcclxuICAgIHRoaXMuYXBpRXZlbnRzQ29uc3VtZXJzLmZvckVhY2goKHJlczogZXhwcmVzcy5SZXNwb25zZSkgPT4gXHJcbiAgICAgIHJlcy53cml0ZShgZGF0YTogJHtKU09OLnN0cmluZ2lmeSh7IHRhZywgcGF5bG9hZCB9KX1cXG5cXG5gKSk7XHJcbiAgfVxyXG5cclxufSlcclxuIiwgImV4cG9ydCBjb25zdCBDT0xPUlMgPSB7XHJcbiAgcmVzZXQ6IFwiXFx4MWJbMG1cIixcclxuICBicmlnaHQ6IFwiXFx4MWJbMW1cIixcclxuICBkaW06IFwiXFx4MWJbMm1cIixcclxuICB1bmRlcnNjb3JlOiBcIlxceDFiWzRtXCIsXHJcbiAgYmxpbms6IFwiXFx4MWJbNW1cIixcclxuICByZXZlcnNlOiBcIlxceDFiWzdtXCIsXHJcbiAgaGlkZGVuOiBcIlxceDFiWzhtXCIsXHJcblxyXG4gIEZHOiB7XHJcbiAgICBibGFjazogXCJcXHgxYlszMG1cIixcclxuICAgIHJlZDogXCJcXHgxYlszMW1cIixcclxuICAgIGdyZWVuOiBcIlxceDFiWzMybVwiLFxyXG4gICAgeWVsbG93OiBcIlxceDFiWzMzbVwiLFxyXG4gICAgYmx1ZTogXCJcXHgxYlszNG1cIixcclxuICAgIG1hZ2VudGE6IFwiXFx4MWJbMzVtXCIsXHJcbiAgICBjeWFuOiBcIlxceDFiWzM2bVwiLFxyXG4gICAgd2hpdGU6IFwiXFx4MWJbMzdtXCIsXHJcbiAgICBncmF5OiBcIlxceDFiWzkwbVwiLFxyXG4gICAgY3JpbXNvbjogXCJcXHgxYlszOG1cIiAvLyBTY2FybGV0XHJcbiAgfSxcclxuICBCRzoge1xyXG4gICAgYmxhY2s6IFwiXFx4MWJbNDBtXCIsXHJcbiAgICByZWQ6IFwiXFx4MWJbNDFtXCIsXHJcbiAgICBncmVlbjogXCJcXHgxYls0Mm1cIixcclxuICAgIHllbGxvdzogXCJcXHgxYls0M21cIixcclxuICAgIGJsdWU6IFwiXFx4MWJbNDRtXCIsXHJcbiAgICBtYWdlbnRhOiBcIlxceDFiWzQ1bVwiLFxyXG4gICAgY3lhbjogXCJcXHgxYls0Nm1cIixcclxuICAgIHdoaXRlOiBcIlxceDFiWzQ3bVwiLFxyXG4gICAgZ3JheTogXCJcXHgxYlsxMDBtXCIsXHJcbiAgICBjcmltc29uOiBcIlxceDFiWzQ4bVwiXHJcbiAgfVxyXG59OyIsICJpbXBvcnQgKiBhcyBMb2cgZnJvbSAnbG9nZ2VyJztcclxuaW1wb3J0IHsgQ09MT1JTIH0gZnJvbSBcIi4vdXRpbHNcIjtcclxuaW1wb3J0IHR5cGUgeyBMb2NhbFN0b3JhZ2UgfSBmcm9tIFwibm9kZS1wZXJzaXN0XCI7XHJcbmltcG9ydCB0eXBlIHsgbWF0dGVyTG9nTGV2ZWwsIG1hdHRlckxvZ0Zvcm1hdCB9IGZyb20gJy4uL3R5cGVzL21vZHVsZSc7XHJcblxyXG5pbXBvcnQgeyBFbmRwb2ludCwgRW5kcG9pbnRTZXJ2ZXIsIEVudmlyb25tZW50LCBTZXJ2ZXJOb2RlLCBTdG9yYWdlU2VydmljZSwgVGltZSB9IGZyb20gXCJAbWF0dGVyL21haW5cIjtcclxuaW1wb3J0IHsgRmFicmljQWN0aW9uLCBsb2dFbmRwb2ludCB9IGZyb20gXCJAbWF0dGVyL21haW4vcHJvdG9jb2xcIjtcclxuaW1wb3J0IHsgQWdncmVnYXRvckVuZHBvaW50IH0gZnJvbSBcIkBtYXR0ZXIvbWFpbi9lbmRwb2ludHMvYWdncmVnYXRvclwiO1xyXG5pbXBvcnQgeyBWZW5kb3JJZCB9IGZyb20gXCJAbWF0dGVyL21haW4vdHlwZXNcIjtcclxuXHJcbmltcG9ydCB7IEJyaWRnZWREZXZpY2VCYXNpY0luZm9ybWF0aW9uU2VydmVyIH0gZnJvbSBcIkBtYXR0ZXIvbWFpbi9iZWhhdmlvcnMvYnJpZGdlZC1kZXZpY2UtYmFzaWMtaW5mb3JtYXRpb25cIjtcclxuaW1wb3J0IHsgT25PZmZQbHVnSW5Vbml0RGV2aWNlIH0gZnJvbSBcIkBtYXR0ZXIvbWFpbi9kZXZpY2VzL29uLW9mZi1wbHVnLWluLXVuaXRcIjtcclxuXHJcbmNvbnN0IE1PRFVMRV9UQUcgPSBgJHtDT0xPUlMucmVzZXR9WyR7Q09MT1JTLkZHLm1hZ2VudGF9TU1NLU1hdHRlciR7Q09MT1JTLnJlc2V0fV0gKCR7Q09MT1JTLkZHLmdyZWVufU1hdHRlclNlcnZlciR7Q09MT1JTLnJlc2V0fSlgO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1hdHRlclNlcnZlciB7XHJcbiAgZW52aXJvbm1lbnQ6IEVudmlyb25tZW50O1xyXG4gIHN0b3JhZ2VTZXJ2aWNlOiBTdG9yYWdlU2VydmljZTtcclxuICBtb2R1bGVTdG9yYWdlU2VydmljZTogTG9jYWxTdG9yYWdlO1xyXG4gIG1kbnNJbnRlcmZhY2U6IHN0cmluZztcclxuICBtb2R1bGVWZXJzaW9uU3RyaW5nOiBzdHJpbmc7XHJcblxyXG4gIHNlcnZlck5vZGU6IFNlcnZlck5vZGU8U2VydmVyTm9kZS5Sb290RW5kcG9pbnQ+O1xyXG4gIHNlcnZlckFnZ3JlZ2F0b3I6IEVuZHBvaW50PEFnZ3JlZ2F0b3JFbmRwb2ludD47XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgbW9kdWxlU3RvcmFnZVNlcnZpY2U6IExvY2FsU3RvcmFnZSxcclxuICAgIG1hdHRlclN0b3JlUGF0aDogc3RyaW5nLFxyXG4gICAgbWF0dGVyTG9nTGV2ZWw6IG1hdHRlckxvZ0xldmVsLFxyXG4gICAgbWF0dGVyTG9nRm9ybWF0OiBtYXR0ZXJMb2dGb3JtYXQsXHJcbiAgICBtb2R1bGVWZXJzaW9uU3RyaW5nLFxyXG4gICAgbWRuc0ludGVyZmFjZT86IHN0cmluZyxcclxuICApIHtcclxuICAgIHRoaXMuZW52aXJvbm1lbnQgPSBFbnZpcm9ubWVudC5kZWZhdWx0O1xyXG4gICAgdGhpcy5lbnZpcm9ubWVudC52YXJzLnNldChcInN0b3JhZ2UucGF0aFwiLCBtYXR0ZXJTdG9yZVBhdGgpO1xyXG4gICAgTG9nLmluZm8oYCR7TU9EVUxFX1RBR30gU3RvcmUgcGF0aCB1cGRhdGVkLiAke0NPTE9SUy5GRy5ncmF5fSR7bWF0dGVyU3RvcmVQYXRofSR7Q09MT1JTLnJlc2V0fWApO1xyXG5cclxuICAgIGlmIChtZG5zSW50ZXJmYWNlKSB0aGlzLmVudmlyb25tZW50LnZhcnMuc2V0KFwibWRucy5uZXR3b3JrSW50ZXJmYWNlXCIsIG1kbnNJbnRlcmZhY2UpO1xyXG4gICAgdGhpcy5tZG5zSW50ZXJmYWNlID0gbWRuc0ludGVyZmFjZTtcclxuICAgIHRoaXMuZW52aXJvbm1lbnQudmFycy5zZXQoXCJsb2cubGV2ZWxcIiwgbWF0dGVyTG9nTGV2ZWwpO1xyXG4gICAgdGhpcy5lbnZpcm9ubWVudC52YXJzLnNldChcImxvZy5mb3JtYXRcIiwgbWF0dGVyTG9nRm9ybWF0KTtcclxuICAgIFxyXG4gICAgdGhpcy5zdG9yYWdlU2VydmljZSA9IHRoaXMuZW52aXJvbm1lbnQuZ2V0KFN0b3JhZ2VTZXJ2aWNlKTtcclxuICAgIHRoaXMubW9kdWxlU3RvcmFnZVNlcnZpY2UgPSBtb2R1bGVTdG9yYWdlU2VydmljZTtcclxuICAgIHRoaXMubW9kdWxlVmVyc2lvblN0cmluZyA9IG1vZHVsZVZlcnNpb25TdHJpbmc7XHJcbiAgfVxyXG4gIFxyXG4gIGFzeW5jIHN0YXJ0U2VydmVyTm9kZSgpIHtcclxuICAgIGNvbnN0IHByb2R1Y3ROYW1lID0gXCJNTU0tTWF0dGVyIEJyaWRnZVwiO1xyXG4gICAgY29uc3QgZGV2aWNlTmFtZSA9IFwiTU1NIEJyaWRnZVwiO1xyXG4gICAgY29uc3QgdmVuZG9yTmFtZSA9IFwiZmFicml6elwiO1xyXG4gICAgY29uc3QgcG9ydCA9IDU1NDA7XHJcblxyXG4gICAgY29uc3QgZGV2aWNlU3RvcmFnZSA9IChhd2FpdCB0aGlzLnN0b3JhZ2VTZXJ2aWNlLm9wZW4oXCJkZXZpY2VcIikpLmNyZWF0ZUNvbnRleHQoXCJkYXRhXCIpO1xyXG4gICAgY29uc3QgcGFzc2NvZGUgPSBhd2FpdCBkZXZpY2VTdG9yYWdlLmdldChcInBhc3Njb2RlXCIsIDIwMjAyMDIxKTtcclxuICAgIGNvbnN0IGRpc2NyaW1pbmF0b3IgPSBhd2FpdCBkZXZpY2VTdG9yYWdlLmdldChcImRpc2NyaW1pbmF0b3JcIiwgMzg0MCk7XHJcbiAgICBjb25zdCB2ZW5kb3JJZCA9IGF3YWl0IGRldmljZVN0b3JhZ2UuZ2V0KFwidmVuZG9yaWRcIiwgMHhmZmYxKTtcclxuICAgIGNvbnN0IHByb2R1Y3RJZCA9IGF3YWl0IGRldmljZVN0b3JhZ2UuZ2V0KFwicHJvZHVjdGlkXCIsIDB4ODAwMCk7XHJcbiAgICBjb25zdCB1bmlxdWVJZCA9IChhd2FpdCBkZXZpY2VTdG9yYWdlLmdldChcInVuaXF1ZWlkXCIsIFRpbWUubm93TXMoKS50b1N0cmluZygpKSk7XHJcblxyXG4gICAgYXdhaXQgZGV2aWNlU3RvcmFnZS5zZXQoe1xyXG4gICAgICBwYXNzY29kZSxcclxuICAgICAgZGlzY3JpbWluYXRvcixcclxuICAgICAgdmVuZG9yaWQ6IHZlbmRvcklkLFxyXG4gICAgICBwcm9kdWN0aWQ6IHByb2R1Y3RJZCxcclxuICAgICAgdW5pcXVlaWQ6IHVuaXF1ZUlkLFxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5zZXJ2ZXJOb2RlID0gYXdhaXQgU2VydmVyTm9kZS5jcmVhdGUoe1xyXG4gICAgICAvLyBSZXF1aXJlZDogR2l2ZSB0aGUgTm9kZSBhIHVuaXF1ZSBJRCB3aGljaCBpcyB1c2VkIHRvIHN0b3JlIHRoZSBzdGF0ZSBvZiB0aGlzIG5vZGVcclxuICAgICAgaWQ6IHVuaXF1ZUlkLFxyXG5cclxuICAgICAgbmV0d29yazoge1xyXG4gICAgICAgIHBvcnRcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGNvbW1pc3Npb25pbmc6IHtcclxuICAgICAgICBwYXNzY29kZSxcclxuICAgICAgICBkaXNjcmltaW5hdG9yLFxyXG4gICAgICB9LFxyXG5cclxuICAgICAgcHJvZHVjdERlc2NyaXB0aW9uOiB7XHJcbiAgICAgICAgbmFtZTogZGV2aWNlTmFtZSxcclxuICAgICAgICBkZXZpY2VUeXBlOiBBZ2dyZWdhdG9yRW5kcG9pbnQuZGV2aWNlVHlwZSxcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIFByb3ZpZGUgZGVmYXVsdHMgZm9yIHRoZSBCYXNpY0luZm9ybWF0aW9uIGNsdXN0ZXIgb24gdGhlIFJvb3QgZW5kcG9pbnRcclxuICAgICAgYmFzaWNJbmZvcm1hdGlvbjoge1xyXG4gICAgICAgIHZlbmRvck5hbWUsXHJcbiAgICAgICAgdmVuZG9ySWQ6IFZlbmRvcklkKHZlbmRvcklkKSxcclxuICAgICAgICBub2RlTGFiZWw6IHByb2R1Y3ROYW1lLFxyXG4gICAgICAgIHByb2R1Y3ROYW1lLFxyXG4gICAgICAgIHByb2R1Y3RMYWJlbDogcHJvZHVjdE5hbWUsXHJcbiAgICAgICAgcHJvZHVjdElkLFxyXG4gICAgICAgIHNlcmlhbE51bWJlcjogYE1NTS1NQVRURVItJHt1bmlxdWVJZH1gLFxyXG4gICAgICAgIHVuaXF1ZUlkLFxyXG4gICAgICAgIGhhcmR3YXJlVmVyc2lvblN0cmluZzogdGhpcy5tb2R1bGVWZXJzaW9uU3RyaW5nLFxyXG4gICAgICAgIHNvZnR3YXJlVmVyc2lvblN0cmluZzogdGhpcy5tb2R1bGVWZXJzaW9uU3RyaW5nLFxyXG4gICAgICAgIGhhcmR3YXJlVmVyc2lvbjogMSxcclxuICAgICAgICBzb2Z0d2FyZVZlcnNpb246IDEsXHJcbiAgICAgICAgcHJvZHVjdFVybDogXCJodHRwczovL2dpdGh1Yi5jb20vRmFicml6ei9NTU0tTWF0dGVyXCIsXHJcbiAgICAgICAgcmVhY2hhYmxlOiB0cnVlLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5zZXJ2ZXJBZ2dyZWdhdG9yID0gbmV3IEVuZHBvaW50KEFnZ3JlZ2F0b3JFbmRwb2ludCwgeyBpZDogXCJhZ2dyZWdhdG9yXCIgfSk7XHJcbiAgICBhd2FpdCB0aGlzLnNlcnZlck5vZGUuYWRkKHRoaXMuc2VydmVyQWdncmVnYXRvcik7XHJcblxyXG4gICAgYXdhaXQgdGhpcy5hZGRTYXZlZEVuZHBvaW50c1RvU2VydmVyKCk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGV2ZW50IGlzIHRyaWdnZXJlZCB3aGVuIHRoZSBkZXZpY2UgaXMgaW5pdGlhbGx5IGNvbW1pc3Npb25lZCBzdWNjZXNzZnVsbHkuXHJcbiAgICAgKiBUaGlzIG1lYW5zOiBJdCBpcyBhZGRlZCB0byB0aGUgZmlyc3QgZmFicmljLlxyXG4gICAgICovXHJcbiAgICB0aGlzLnNlcnZlck5vZGUubGlmZWN5Y2xlLmNvbW1pc3Npb25lZC5vbigoKSA9PiBjb25zb2xlLmxvZyhcIlNlcnZlciB3YXMgaW5pdGlhbGx5IGNvbW1pc3Npb25lZCBzdWNjZXNzZnVsbHkhXCIpKTtcclxuXHJcbiAgICAvKiogVGhpcyBldmVudCBpcyB0cmlnZ2VyZWQgd2hlbiBhbGwgZmFicmljcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBkZXZpY2UsIHVzdWFsbHkgaXQgYWxzbyBkb2VzIGEgZmFjdG9yeSByZXNldCB0aGVuLiAqL1xyXG4gICAgdGhpcy5zZXJ2ZXJOb2RlLmxpZmVjeWNsZS5kZWNvbW1pc3Npb25lZC5vbigoKSA9PiBjb25zb2xlLmxvZyhcIlNlcnZlciB3YXMgZnVsbHkgZGVjb21taXNzaW9uZWQgc3VjY2Vzc2Z1bGx5IVwiKSk7XHJcblxyXG4gICAgLyoqIFRoaXMgZXZlbnQgaXMgdHJpZ2dlcmVkIHdoZW4gdGhlIGRldmljZSB3ZW50IG9ubGluZS4gVGhpcyBtZWFucyB0aGF0IGl0IGlzIGRpc2NvdmVyYWJsZSBpbiB0aGUgbmV0d29yay4gKi9cclxuICAgIHRoaXMuc2VydmVyTm9kZS5saWZlY3ljbGUub25saW5lLm9uKCgpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJTZXJ2ZXIgaXMgb25saW5lXCIpO1xyXG4gICAgICBjb25zb2xlLmxvZyhcIkluaXRpYWwgRmFicmljcyB3aGVuIGNvbWluZyBvbmxpbmVcIiwgdGhpcy5zZXJ2ZXJOb2RlLnN0YXRlLmNvbW1pc3Npb25pbmcuZmFicmljcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKiogVGhpcyBldmVudCBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgZGV2aWNlIHdlbnQgb2ZmbGluZS4gSXQgaXMgbm8gbG9uZ2VyIGRpc2NvdmVyYWJsZSBvciBjb25uZWN0YWJsZSBpbiB0aGUgbmV0d29yay4gKi9cclxuICAgIHRoaXMuc2VydmVyTm9kZS5saWZlY3ljbGUub2ZmbGluZS5vbigoKSA9PiBjb25zb2xlLmxvZyhcIlNlcnZlciBpcyBvZmZsaW5lXCIpKTtcclxuXHJcbiAgICAvKiogVGhpcyBldmVudCBpcyB0cmlnZ2VyZWQgd2hlbiBhIGZhYnJpYyBpcyBhZGRlZCwgcmVtb3ZlZCBvciB1cGRhdGVkIG9uIHRoZSBkZXZpY2UuICovXHJcbiAgICB0aGlzLnNlcnZlck5vZGUuZXZlbnRzLmNvbW1pc3Npb25pbmcuZmFicmljc0NoYW5nZWQub24oKGZhYnJpY0luZGV4LCBmYWJyaWNBY3Rpb24pID0+IHtcclxuICAgICAgbGV0IGFjdGlvbiA9IFwiXCI7XHJcbiAgICAgIHN3aXRjaCAoZmFicmljQWN0aW9uKSB7XHJcbiAgICAgICAgY2FzZSBGYWJyaWNBY3Rpb24uQWRkZWQ6XHJcbiAgICAgICAgICBhY3Rpb24gPSBcImFkZGVkXCI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIEZhYnJpY0FjdGlvbi5SZW1vdmVkOlxyXG4gICAgICAgICAgYWN0aW9uID0gXCJyZW1vdmVkXCI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIEZhYnJpY0FjdGlvbi5VcGRhdGVkOlxyXG4gICAgICAgICAgYWN0aW9uID0gXCJ1cGRhdGVkXCI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjb25zb2xlLmxvZyhgQ29tbWlzc2lvbmVkIEZhYnJpY3MgY2hhbmdlZCBldmVudCAoJHthY3Rpb259KSBmb3IgJHtmYWJyaWNJbmRleH0gdHJpZ2dlcmVkYCwgdGhpcy5zZXJ2ZXJOb2RlLnN0YXRlLmNvbW1pc3Npb25pbmcuZmFicmljc1tmYWJyaWNJbmRleF0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYXdhaXQgdGhpcy5zZXJ2ZXJOb2RlLnN0YXJ0KCk7XHJcbiAgICBsb2dFbmRwb2ludChFbmRwb2ludFNlcnZlci5mb3JFbmRwb2ludCh0aGlzLnNlcnZlck5vZGUpKTtcclxuXHJcbiAgICAvLyBDb21taXNpb25pbmcgbG9naWNcclxuICAgIGlmICghdGhpcy5zZXJ2ZXJOb2RlLmxpZmVjeWNsZS5pc0NvbW1pc3Npb25lZCkge1xyXG4gICAgICBjb25zdCB7IHFyUGFpcmluZ0NvZGUsIG1hbnVhbFBhaXJpbmdDb2RlIH0gPSB0aGlzLnNlcnZlck5vZGUuc3RhdGUuY29tbWlzc2lvbmluZy5wYWlyaW5nQ29kZXM7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFFSIENvZGUgVVJMOiBodHRwczovL3Byb2plY3QtY2hpcC5naXRodWIuaW8vY29ubmVjdGVkaG9tZWlwL3FyY29kZS5odG1sP2RhdGE9JHtxclBhaXJpbmdDb2RlfWApO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBNYW51YWwgcGFpcmluZyBjb2RlOiAke21hbnVhbFBhaXJpbmdDb2RlfWApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkRldmljZSBpcyBhbHJlYWR5IGNvbW1pc3Npb25lZC4gV2FpdGluZyBmb3IgY29udHJvbGxlcnMgdG8gY29ubmVjdCAuLi5cIik7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgYXN5bmMgYWRkU2F2ZWRFbmRwb2ludHNUb1NlcnZlcigpIHtcclxuICAgIGNvbnN0IG5hbWUgPSBgT25PZmYgbGlnaHRgO1xyXG5cclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGNvbnN0IGVuZHBvaW50ID0gbmV3IEVuZHBvaW50KFxyXG4gICAgICBPbk9mZlBsdWdJblVuaXREZXZpY2Uud2l0aChCcmlkZ2VkRGV2aWNlQmFzaWNJbmZvcm1hdGlvblNlcnZlciksXHJcbiAgICAgIHtcclxuICAgICAgICBpZDogYG9ub2ZmLTFgLFxyXG4gICAgICAgIGJyaWRnZWREZXZpY2VCYXNpY0luZm9ybWF0aW9uOiB7XHJcbiAgICAgICAgICBub2RlTGFiZWw6IG5hbWUsIC8vIE1haW4gZW5kIHVzZXIgbmFtZSBmb3IgdGhlIGRldmljZVxyXG4gICAgICAgICAgcHJvZHVjdE5hbWU6IG5hbWUsXHJcbiAgICAgICAgICBwcm9kdWN0TGFiZWw6IG5hbWUsXHJcbiAgICAgICAgICBzZXJpYWxOdW1iZXI6IGBub2RlLW1hdHRlci0xYCxcclxuICAgICAgICAgIHJlYWNoYWJsZTogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIGF3YWl0IHRoaXMuc2VydmVyQWdncmVnYXRvci5hZGQoZW5kcG9pbnQpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXIgc3RhdGUgY2hhbmdlIGhhbmRsZXJzIGFuZCBldmVudHMgb2YgdGhlIGVuZHBvaW50IGZvciBpZGVudGlmeSBhbmQgb25vZmYgc3RhdGVzIHRvIHJlYWN0IHRvIHRoZSBjb21tYW5kcy5cclxuICAgICAqXHJcbiAgICAgKiBJZiB0aGUgY29kZSBpbiB0aGVzZSBjaGFuZ2UgaGFuZGxlcnMgZmFpbCB0aGVuIHRoZSBjaGFuZ2UgaXMgYWxzbyByb2xsZWQgYmFjayBhbmQgbm90IGV4ZWN1dGVkIGFuZCBhbiBlcnJvciBpc1xyXG4gICAgICogcmVwb3J0ZWQgYmFjayB0byB0aGUgY29udHJvbGxlci5cclxuICAgICAqL1xyXG4gICAgZW5kcG9pbnQuZXZlbnRzLmlkZW50aWZ5LnN0YXJ0SWRlbnRpZnlpbmcub24oKCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhgUnVuIGlkZW50aWZ5IGxvZ2ljIGZvciAke25hbWV9LCBpZGVhbGx5IGJsaW5rIGEgbGlnaHQgZXZlcnkgMC41cyAuLi5gKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGVuZHBvaW50LmV2ZW50cy5pZGVudGlmeS5zdG9wSWRlbnRpZnlpbmcub24oKCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhgU3RvcCBpZGVudGlmeSBsb2dpYyBmb3IgJHtuYW1lfSAuLi5gKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGVuZHBvaW50LmV2ZW50cy5vbk9mZi5vbk9mZiRDaGFuZ2VkLm9uKHZhbHVlID0+IHtcclxuICAgICAgY29uc29sZS5sb2coYCR7bmFtZX0gaXMgbm93ICR7dmFsdWUgPyBcIk9OXCIgOiBcIk9GRlwifWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7OzJjQUVBLElBQUFBLEVBQTRCLDBCQUM1QkMsRUFBcUIscUJBQ3JCQyxFQUF5QixzQkFDekJDLEVBQXNCLG1CQUN0QkMsRUFBNkIsa0JDTnRCLElBQU1DLEVBQVMsQ0FDcEIsTUFBTyxVQUNQLE9BQVEsVUFDUixJQUFL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SUFBQUUsRUFBSyxRQUFBRixDQUFRLENBQUMsRUFDOUYsS0FBSyx1QkFBdUIsa0JBQW1CLENBQUUsSUFBQUUsRUFBSyxRQUFBRixDQUFRLENBQUMsQ0FDakUsRUFFQSx3QkFBd0JFLEVBQUtGLEVBQVUsQ0FBQyxFQUFHLENBQ3pDLEtBQUssbUJBQW1CLFFBQVNILEdBQy9CQSxFQUFJLE1BQU0sU0FBUyxLQUFLLFVBQVUsQ0FBRSxJQUFBSyxFQUFLLFFBQUFGLENBQVEsQ0FBQyxDQUFDO0FBQUE7QUFBQSxDQUFNLENBQUMsQ0FDOUQsQ0FFRixDQUFDIiwKICAibmFtZXMiOiBbIk5vZGVIZWxwZXIiLCAiTG9nIiwgImV4cHJlc3MiLCAicGF0aCIsICJpbXBvcnRfZXZlbnRzIiwgIkNPTE9SUyIsICJMb2ciLCAiaW1wb3J0X21haW4iLCAiaW1wb3J0X3Byb3RvY29sIiwgImltcG9ydF9hZ2dyZWdhdG9yIiwgImltcG9ydF90eXBlcyIsICJpbXBvcnRfYnJpZGdlZF9kZXZpY2VfYmFzaWNfaW5mb3JtYXRpb24iLCAiaW1wb3J0X29uX29mZl9wbHVnX2luX3VuaXQiLCAiTU9EVUxFX1RBRyIsICJDT0xPUlMiLCAiTWF0dGVyU2VydmVyIiwgIm1vZHVsZVN0b3JhZ2VTZXJ2aWNlIiwgIm1hdHRlclN0b3JlUGF0aCIsICJtYXR0ZXJMb2dMZXZlbCIsICJtYXR0ZXJMb2dGb3JtYXQiLCAibW9kdWxlVmVyc2lvblN0cmluZyIsICJtZG5zSW50ZXJmYWNlIiwgInByb2R1Y3ROYW1lIiwgImRldmljZU5hbWUiLCAidmVuZG9yTmFtZSIsICJkZXZpY2VTdG9yYWdlIiwgInBhc3Njb2RlIiwgImRpc2NyaW1pbmF0b3IiLCAidmVuZG9ySWQiLCAicHJvZHVjdElkIiwgInVuaXF1ZUlkIiwgImZhYnJpY0luZGV4IiwgImZhYnJpY0FjdGlvbiIsICJhY3Rpb24iLCAicXJQYWlyaW5nQ29kZSIsICJtYW51YWxQYWlyaW5nQ29kZSIsICJuYW1lIiwgImVuZHBvaW50IiwgInZhbHVlIiwgInN0b3JhZ2UiLCAiUEFUSF9NT0RVTEVfU1RPUkUiLCAiUEFUSF9NQVRURVJfU1RPUkUiLCAiUEFUSF9DTElFTlRfRElTVCIsICJNT0RVTEVfVkVSU0lPTiIsICJNT0RVTEVfVEFHIiwgIkNPTE9SUyIsICJyb3V0ZXIiLCAiYXBpUm91dGVyIiwgInEiLCAiciIsICJyZXEiLCAicmVzIiwgImNsaWVudElkIiwgIm5vdGlmaWNhdGlvbiIsICJwYXlsb2FkIiwgIk1hdHRlclNlcnZlciIsICJ0YWciXQp9Cg==
